(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{BNN:()=>c,CBNN:()=>a,CBNNLayer:()=>u,CBNNLayerVocabulary:()=>s,CBNNLoader:()=>o,CBNNSaver:()=>i,default:()=>l});var n=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))},r=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,r=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(6===u[0]&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(t,s)}catch(t){u=[6,t],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},i=function(){function t(){}return t.prototype.save=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,!1]}))}))},t}(),o=function(){function t(){}return t.prototype.load=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,!1]}))}))},t}(),s=function(){this.tokens={}},u=function(){function t(t){var e=this;this.vocabulary=new s,this.learnsCount=0,this.classes={},this._normalizer=function(t){return n(e,void 0,void 0,(function(){return r(this,(function(e){return[2,t]}))}))},this._tokenizer=function(t){return n(e,void 0,void 0,(function(){return r(this,(function(e){return[2,t.toUpperCase().split(/[\s\.,;:?!"']+/gm)]}))}))},this._sanitizer=function(t){return n(e,void 0,void 0,(function(){return r(this,(function(e){return[2,t]}))}))},this._limitizer=function(t,i){return n(e,void 0,void 0,(function(){return r(this,(function(e){return[2,t>0&&i>1]}))}))},void 0!==t&&Object.assign(this,t)}return t.prototype.setNormalizer=function(t){this._normalizer=t},t.prototype.setTokenizer=function(t){this._tokenizer=t},t.prototype.setSanitizer=function(t){this._sanitizer=t},t.prototype.setLimitizer=function(t){this._limitizer=t},t.prototype.learn=function(t,e){return n(this,void 0,void 0,(function(){var n,i,o,s,u,a;return r(this,(function(r){switch(r.label){case 0:return[4,this._normalizer(t)];case 1:return n=r.sent(),o=this._sanitizer,[4,this._tokenizer(n)];case 2:return[4,o.apply(this,[r.sent()])];case 3:for(i=r.sent(),this.learnsCount++,s=0,u=i;s<u.length;s++)a=u[s],void 0===this.classes[e]&&(this.classes[e]={key:e,frequency:0,tokens:{}}),this.classes[e].frequency++,void 0===this.classes[e].tokens[a]&&(this.classes[e].tokens[a]={key:a,frequency:0,classes:{}}),this.classes[e].tokens[a].frequency++,void 0===this.vocabulary.tokens[a]&&(this.vocabulary.tokens[a]={key:a,frequency:0,classes:{}}),this.vocabulary.tokens[a].frequency++,void 0===this.vocabulary.tokens[a].classes[e]&&(this.vocabulary.tokens[a].classes[e]={key:e,frequency:0,tokens:{}});return[2]}}))}))},t.prototype.classify=function(t){return n(this,void 0,void 0,(function(){var e,n,i,o,s,u,a,c,l,f,h,y,p,v;return r(this,(function(r){switch(r.label){case 0:return[4,this._normalizer(t)];case 1:return e=r.sent(),i=this._sanitizer,[4,this._tokenizer(e)];case 2:return[4,i.apply(this,[r.sent()])];case 3:n=r.sent(),o={},s=0,u=n,r.label=4;case 4:if(!(s<u.length))return[3,9];if(a=u[s],void 0===this.vocabulary.tokens[a])return[3,8];for(f in c=this.vocabulary.tokens[a].classes,l=[],c)l.push(f);h=0,r.label=5;case 5:return h<l.length?(f=l[h])in c?(void 0===o[y=f]&&(o[y]=0),[4,this._limitizer(this.classes[y].frequency,this.classes[y].tokens[a].frequency)]):[3,7]:[3,8];case 6:r.sent()&&(o[y]+=this.classes[y].tokens[a].frequency/this.classes[y].frequency),r.label=7;case 7:return h++,[3,5];case 8:return s++,[3,4];case 9:return p=Object.values(o).reduce((function(t,e){return t+e}),0),v=Object.keys(o).map((function(t){return{class:t,trust:o[t]/p*100}})),[2,v.sort((function(t,e){return e.trust-t.trust}))]}}))}))},t}(),a=function(){function t(){this._layers={}}return t.prototype.addLayer=function(t,e){return void 0===e&&(e=new u({key:t})),this._layers[t]=e,this._layers[t]},t.prototype.removeLayer=function(t){delete this._layers[t]},t.prototype.getLayer=function(t){return this._layers[t]},t.prototype.setSaver=function(t){this._saver=t},t.prototype.setLoader=function(t){this._loader=t},t.prototype.learn=function(t,e,i){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){return void 0===(n=this.getLayer(t))&&(n=this.addLayer(t)),[2,n.learn(e,i)]}))}))},t.prototype.classify=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(n){return[2,this.getLayer(t).classify(e)]}))}))},t.prototype.save=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this._saver.save()];case 1:return[2,t.sent()]}}))}))},t.prototype.loader=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this._loader.load()];case 1:return[2,t.sent()]}}))}))},t}(),c=function(t){return new a};const l=c;module.exports=e})();